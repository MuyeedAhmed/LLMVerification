Actual prompt:
Modify the function in the provided old.c: void vsf_secutil_change_credentials(const struct mystr* p_user_str, const struct mystr* p_dir_str, const struct mystr* p_ext_dir_str, unsigned int caps, unsigned int options), such that it Add stronger checks for the configuration error of running with a writeable root directory inside a chroot(). don't ever chroot() to a directory writable by the current user.. Provide only the functional implementation. Do not include any explaination or use case.